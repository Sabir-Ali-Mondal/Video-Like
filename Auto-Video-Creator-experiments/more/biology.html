<!-- 
    AUTO-VIDEO v3.1 | THE OMNI-ENGINE FINAL
    - Multi-Language Auto-Detect AI
    - 4-Stage Zero-Fail Asset System
    - Smart Background Preloader
    - 60-Scene Omni-Demo Included
-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Auto-Video Elite</title>

    <!-- LIBRARIES -->
    <script src="https://js.puter.com/v2/"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800;900&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #6366f1;
            --glass: rgba(10, 10, 12, 0.9);
            --border: rgba(255, 255, 255, 0.12);
            --ease: cubic-bezier(0.19, 1, 0.22, 1);
        }

        body {
            background-color: #000;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
            color: white;
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* STAGE */
        #stage-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background: radial-gradient(circle at center, #111 0%, #000 100%);
            position: relative;
        }

        #stage-content {
            background: #000;
            position: relative;
            aspect-ratio: 16/9;
            width: 100%;
            max-width: calc((100vh - 100px) * (16/9));
            box-shadow: 0 0 0 1px #333, 0 50px 100px -20px rgba(0, 0, 0, 0.8);
            overflow: hidden;
            container-type: size;
            transition: aspect-ratio 0.5s var(--ease);
        }

        #stage-content.portrait {
            aspect-ratio: 9/16;
            max-width: none;
            height: 95vh;
            width: auto;
        }

        /* TEXT UTILS */
        .ts-sm {
            font-size: 2cqw;
        }

        .ts-base {
            font-size: 3.5cqw;
        }

        .ts-lg {
            font-size: 6cqw;
        }

        .ts-xl {
            font-size: 10cqw;
            line-height: 0.9;
        }

        .ts-huge {
            font-size: 15cqw;
            line-height: 0.8;
            letter-spacing: -0.05em;
        }

        /* FALLBACK BACKGROUNDS */
        .bg-fallback-tech {
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 4cqw 4cqw;
        }

        /* UI DOCK */
        .ui-layer {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            width: auto;
            min-width: 300px;
            height: 70px;
            background: var(--glass);
            border: 1px solid var(--border);
            border-radius: 35px;
            display: flex;
            align-items: center;
            gap: 1.5rem;
            padding: 0 1.5rem;
            z-index: 2000;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6);
        }

        .btn-ui {
            background: rgba(255, 255, 255, 0.05);
            color: #94a3b8;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            transition: 0.2s;
            position: relative;
        }

        .btn-ui:hover {
            background: white;
            color: black;
            transform: translateY(-2px);
        }

        .btn-ui.active {
            background: var(--primary);
            color: white;
        }

        .btn-play {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: white;
            color: black;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        }

        .btn-play:hover {
            background: #e0e7ff;
            color: var(--primary);
            transform: scale(1.1);
        }

        /* SYSTEM MENU */
        #system-menu {
            position: absolute;
            bottom: 90px;
            left: 0;
            background: #09090b;
            border: 1px solid var(--border);
            border-radius: 20px;
            width: 260px;
            padding: 8px;
            display: none;
            flex-direction: column;
            gap: 4px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.8);
            transform-origin: bottom left;
            animation: menuPop 0.2s var(--ease);
        }

        #system-menu.open {
            display: flex;
        }

        @keyframes menuPop {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(10px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 12px;
            color: #e2e8f0;
            font-size: 0.9rem;
            cursor: pointer;
            transition: 0.2s;
        }

        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .menu-item i {
            font-size: 1.1rem;
            opacity: 0.7;
        }

        /* MODALS */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 5000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.open {
            display: flex;
        }

        .modal-box {
            width: 800px;
            max-width: 90%;
            background: #09090b;
            border: 1px solid #27272a;
            border-radius: 24px;
            padding: 32px;
        }

        .slide-layer {
            position: absolute;
            inset: 0;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s var(--ease);
            z-index: 1;
        }

        .slide-layer.active {
            opacity: 1;
            pointer-events: auto;
            z-index: 10;
        }

        .marker-swipe {
            background: linear-gradient(120deg, transparent 50%, var(--primary) 50%);
            background-size: 250%;
            background-position: 0%;
            transition: background-position 0.5s ease-out;
            padding: 0 4px;
        }

        .marker-swipe.active {
            background-position: 100%;
            color: white;
        }
    </style>
</head>

<body>
    <div id="stage-container">
        <div id="stage-content"></div>
    </div>

    <!-- MAIN DOCK -->
    <div class="ui-layer">
        <div class="relative">
            <button class="btn-ui" onclick="Engine.ui.toggleMenu()" id="menu-btn"><i class="bi bi-grid-fill"></i></button>
            <div id="system-menu">
                <div class="menu-item" onclick="Engine.ui.openModal('ai')">
                    <i class="bi bi-robot text-purple-400"></i> AI Architect
                </div>
                <div class="menu-item" onclick="Engine.ui.openModal('settings')">
                    <i class="bi bi-sliders text-blue-400"></i> Studio Settings
                </div>
                <div class="menu-item" onclick="Engine.ui.openModal('import')">
                    <i class="bi bi-code-slash text-green-400"></i> Code Editor
                </div>
                <div class="h-[1px] bg-white/10 my-1"></div>
                <div class="menu-item" onclick="Engine.ui.toggleRatio()">
                    <i class="bi bi-phone"></i> Toggle Portrait
                </div>
            </div>
        </div>

        <button class="btn-ui hide-mobile" onclick="Engine.prev()"><i class="bi bi-skip-start-fill"></i></button>
        <button class="btn-play" id="play-btn" onclick="Engine.togglePlay()"><i class="bi bi-play-fill"></i></button>
        <button class="btn-ui hide-mobile" onclick="Engine.next()"><i class="bi bi-skip-end-fill"></i></button>
        <button class="btn-ui" onclick="Engine.ui.toggleFullscreen()"><i class="bi bi-arrows-fullscreen"></i></button>
    </div>

    <!-- AI MODAL -->
    <div id="modal-ai" class="modal-overlay">
        <div class="modal-box">
            <h2 class="text-3xl font-black text-white italic mb-2">AI ARCHITECT <span class="bg-primary/20 text-primary text-xs px-2 py-1 rounded not-italic ml-2">v3.1</span></h2>
            <textarea id="ai-prompt" class="w-full bg-black/50 border border-white/10 rounded-xl p-4 text-white focus:border-primary outline-none h-32 mb-6" placeholder="Describe the video topic..."></textarea>

            <div class="grid grid-cols-2 gap-4 mb-6">
                <div>
                    <label class="text-xs text-gray-500 font-bold mb-2 block">NARRATION LANGUAGE (AUTO)</label>
                    <select id="ai-lang" class="w-full bg-black border border-white/10 rounded-lg p-3 text-sm text-white"></select>
                </div>
                <div>
                    <label class="text-xs text-gray-500 font-bold mb-2 block">VISUAL STYLE</label>
                    <select id="ai-style" class="w-full bg-black border border-white/10 rounded-lg p-3 text-sm text-white">
                        <option value="cinematic">Cinematic Documentary</option>
                        <option value="tech">High-Tech / Cyberpunk</option>
                        <option value="paper">Minimal / Journalistic</option>
                        <option value="retro">Retro / VHS Style</option>
                    </select>
                </div>
            </div>

            <button id="gen-btn" onclick="Engine.ai.generate()" class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-4 rounded-xl tracking-widest transition-all">GENERATE PROJECT</button>
            <button onclick="Engine.ui.closeModal()" class="w-full mt-4 text-gray-500 hover:text-white py-2 text-xs">CANCEL</button>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="modal-settings" class="modal-overlay">
        <div class="modal-box">
            <h2 class="text-2xl font-bold text-white mb-6">Studio Settings</h2>
            <div class="mb-6">
                <label class="text-xs text-gray-400 block mb-1">NARRATOR VOICE</label>
                <select id="voice-select" class="w-full bg-black border border-white/10 rounded p-2 text-white text-sm" onchange="Engine.audio.setVoice(this.value)"></select>
            </div>
            <div class="mb-6">
                <label class="text-xs text-gray-400 block mb-1">BACKGROUND MUSIC</label>
                <select id="music-select" class="w-full bg-black border border-white/10 rounded p-2 text-white text-sm" onchange="Engine.audio.setTrack(this.value)">
                    <option value="https://res.cloudinary.com/dmttn34te/video/upload/v1763064765/study-music-181044_jbuwpq.mp3">Cinematic Ambient</option>
                    <option value="upload">Upload Custom...</option>
                </select>
                <input type="file" id="music-upload" hidden accept="audio/*" onchange="Engine.audio.handleUpload(this)">
            </div>
            <button onclick="Engine.ui.closeModal()" class="bg-white/10 w-full py-3 rounded-lg text-white font-bold">DONE</button>
        </div>
    </div>

    <!-- CODE MODAL -->
    <div id="modal-import" class="modal-overlay">
        <div class="modal-box w-[900px]">
            <h2 class="text-xl font-bold text-white mb-4">Project JSON Editor</h2>
            <textarea id="json-editor" class="w-full h-[400px] bg-[#0d1117] text-green-400 font-mono text-xs p-4 rounded-lg border border-white/10 outline-none resize-none"></textarea>
            <div class="mt-4 flex gap-3">
                <button onclick="Engine.io.apply()" class="flex-1 bg-green-600 text-white font-bold py-3 rounded-lg">APPLY</button>
                <button onclick="Engine.ui.closeModal()" class="px-6 py-3 text-gray-400 hover:text-white">CLOSE</button>
            </div>
        </div>
    </div>

    <script>
        const Engine = {
            data: null,
            state: {
                scene: 0,
                step: 0,
                paused: true,
                voice: null
            },
            audioEl: new Audio(),
            tts: window.speechSynthesis,

            init: () => {
                Engine.audioEl.loop = true;
                Engine.audioEl.volume = 0.3;

                // --- SYSTEM INITIALIZATION ---
                const systemInit = () => {
                    const voices = Engine.tts.getVoices();

                    // 1. Settings Voice Dropdown
                    const settingsSel = document.getElementById('voice-select');
                    settingsSel.innerHTML = voices.map((v, i) => `<option value="${i}">${v.name} (${v.lang})</option>`).join('');

                    // 2. AI Language Dropdown (Auto-Detect)
                    const aiSel = document.getElementById('ai-lang');
                    aiSel.innerHTML = '';
                    const uniqueLangs = [...new Set(voices.map(v => v.lang))].sort();

                    uniqueLangs.forEach(langCode => {
                        const opt = document.createElement('option');
                        opt.value = langCode;
                        try {
                            const readable = new Intl.DisplayNames([navigator.language], {
                                type: 'language'
                            }).of(langCode);
                            opt.text = `${readable} (${langCode})`;
                        } catch (e) {
                            opt.text = langCode;
                        }
                        aiSel.appendChild(opt);
                    });

                    // 3. Set Defaults
                    const defaultVoiceIdx = voices.findIndex(v => v.lang.startsWith('en'));
                    Engine.state.voice = voices[defaultVoiceIdx > -1 ? defaultVoiceIdx : 0];
                    settingsSel.value = defaultVoiceIdx > -1 ? defaultVoiceIdx : 0;

                    const enLang = uniqueLangs.find(l => l.startsWith('en'));
                    if (enLang) aiSel.value = enLang;
                };

                if (Engine.tts.getVoices().length > 0) systemInit();
                else Engine.tts.onvoiceschanged = systemInit;

                // Load Omni Demo
                Engine.load(DEMO_DATA);
            },

            load: (json) => {
                Engine.data = json;
                Engine.state.scene = 0;
                Engine.state.step = 0;
                Engine.state.paused = true;
                if (json.meta.audio) Engine.audioEl.src = json.meta.audio;
                Engine.render(0);
                Engine.loader.preload(1);
                Engine.ui.update();
            },

            gfx: {
                handleError: (img) => {
                    const sceneIdx = parseInt(img.dataset.sceneIndex || 0);
                    const attempt = parseInt(img.dataset.failCount || 0) + 1;
                    img.dataset.failCount = attempt;

                    // Stage 2: Backup SVG
                    if (attempt === 1) {
                        const scene = Engine.data.scenes[sceneIdx];
                        if (scene.backup_svg) {
                            const div = document.createElement('div');
                            div.innerHTML = scene.backup_svg;
                            div.className = "w-full h-full flex items-center justify-center bg-gray-900";
                            img.replaceWith(div);
                            return;
                        }
                    }
                    // Stage 3: Random Fallback
                    if (attempt <= 2) {
                        img.src = `https://picsum.photos/seed/${sceneIdx}_abstract/1920/1080?grayscale&blur=2`;
                        return;
                    }
                    // Stage 4: CSS Pattern
                    img.style.display = 'none';
                    img.parentElement.classList.add('bg-fallback-tech', 'bg-gray-900');
                }
            },

            loader: {
                preload: (nextIdx) => {
                    for (let i = nextIdx; i < nextIdx + 2; i++) {
                        if (Engine.data && Engine.data.scenes[i]) {
                            const parser = new DOMParser();
                            const doc = parser.parseFromString(Engine.data.scenes[i].html, 'text/html');
                            doc.querySelectorAll('img').forEach(img => {
                                const i = new Image();
                                i.src = img.src;
                            });
                        }
                    }
                }
            },

            render: (idx) => {
                if (!Engine.data.scenes[idx]) return;
                const stage = document.getElementById('stage-content');
                const scene = Engine.data.scenes[idx];

                const layer = document.createElement('div');
                layer.className = 'slide-layer bg-black';

                // Inject HTML with Error Handler hook
                let processedHTML = scene.html.replace(/<img /g, `<img data-scene-index="${idx}" onerror="Engine.gfx.handleError(this)" `);
                layer.innerHTML = processedHTML;

                stage.appendChild(layer);

                if (scene.script) {
                    setTimeout(() => {
                        try {
                            const fn = new Function('return ' + scene.script)();
                            Engine.state.activeScript = fn({
                                root: layer,
                                chart: (id, cfg) => new Chart(layer.querySelector(id), cfg),
                                map: (id, cfg) => L.map(layer.querySelector(id), cfg),
                                p5: (sketch, id) => new p5(sketch, layer.querySelector(id)),
                                window: window
                            });
                        } catch (e) {
                            console.log(e);
                        }
                    }, 50);
                }

                requestAnimationFrame(() => {
                    layer.classList.add('active');
                    const old = stage.querySelectorAll('.slide-layer:not(:last-child)');
                    old.forEach(l => {
                        l.classList.remove('active');
                        setTimeout(() => l.remove(), 800);
                    });
                });
            },

            playStep: () => {
                if (Engine.state.paused) return;
                const scene = Engine.data.scenes[Engine.state.scene];
                const step = scene.steps[Engine.state.step];

                if (step.actions) {
                    step.actions.forEach(a => {
                        const el = document.querySelector(a.target);
                        if (el && a.type === 'reveal') el.classList.remove('opacity-0', 'translate-y-4', 'scale-90');
                        if (el && a.type === 'highlight') el.classList.add('active');
                        if (a.type === 'custom' && a.fn) a.fn();
                        if (a.type === 'chart-update' && Engine.state.activeScript?.updateChart) Engine.state.activeScript.updateChart(a.value);
                    });
                }

                Engine.tts.cancel();
                const u = new SpeechSynthesisUtterance(step.narration);
                u.voice = Engine.state.voice;
                u.onend = () => {
                    if (!Engine.state.paused) setTimeout(Engine.nextStep, 500);
                };
                Engine.tts.speak(u);
            },

            nextStep: () => {
                if (Engine.state.paused) return;
                const scene = Engine.data.scenes[Engine.state.scene];
                if (Engine.state.step < scene.steps.length - 1) {
                    Engine.state.step++;
                    Engine.playStep();
                } else if (Engine.state.scene < Engine.data.scenes.length - 1) {
                    Engine.state.scene++;
                    Engine.state.step = 0;
                    Engine.render(Engine.state.scene);
                    Engine.loader.preload(Engine.state.scene + 1);
                    setTimeout(Engine.playStep, 1000);
                } else {
                    Engine.togglePlay();
                }
            },

            togglePlay: () => {
                Engine.state.paused = !Engine.state.paused;
                const btn = document.getElementById('play-btn');
                if (!Engine.state.paused) {
                    btn.innerHTML = '<i class="bi bi-pause-fill"></i>';
                    Engine.audioEl.play().catch(() => {});
                    Engine.playStep();
                } else {
                    btn.innerHTML = '<i class="bi bi-play-fill"></i>';
                    Engine.audioEl.pause();
                    Engine.tts.cancel();
                }
            },

            prev: () => {
                if (Engine.state.scene > 0) {
                    Engine.state.paused = true;
                    Engine.state.scene--;
                    Engine.state.step = 0;
                    Engine.render(Engine.state.scene);
                    Engine.ui.update();
                }
            },
            next: () => {
                if (Engine.state.scene < Engine.data.scenes.length - 1) {
                    Engine.state.paused = true;
                    Engine.state.scene++;
                    Engine.state.step = 0;
                    Engine.render(Engine.state.scene);
                    Engine.loader.preload(Engine.state.scene + 1);
                    Engine.ui.update();
                }
            },

            ai: {
                generate: async () => {
                    const prompt = document.getElementById('ai-prompt').value;
                    const langCode = document.getElementById('ai-lang').value;
                    const style = document.getElementById('ai-style').value;
                    const btn = document.getElementById('gen-btn');

                    if (!prompt) return;
                    btn.disabled = true;
                    btn.innerText = "ARCHITECTING...";

                    // Auto-Switch Voice to Match Language Selection
                    const voices = Engine.tts.getVoices();
                    const matchingVoice = voices.find(v => v.lang === langCode) || voices.find(v => v.lang.startsWith(langCode.split('-')[0]));
                    if (matchingVoice) {
                        Engine.state.voice = matchingVoice;
                        const settingsSel = document.getElementById('voice-select');
                        const idx = voices.indexOf(matchingVoice);
                        if (idx > -1) settingsSel.value = idx;
                    }

                    const sys = `
                        # ROLE: Elite Video Architect (v3.1)
                        # TASK: Generate JSON for video topic: "${prompt}".
                        # SETTINGS: Language=${langCode}, Style=${style}.
                        # RULES:
                        1. Structure: { meta: {...}, scenes: [ { type, html, backup_svg, script, steps: [...] } ] }.
                        2. "html": Use Tailwind. Use <img src="UNSPLASH_URL">.
                        3. "backup_svg": Provide an abstract <svg> string as backup for every image.
                        4. "steps": Narrations MUST be in language code: ${langCode}.
                        5. Output raw JSON only.
                    `;

                    try {
                        const res = await puter.ai.chat(sys);
                        const clean = res.message.content.replace(/```json|```/g, '').trim();
                        Engine.load(JSON.parse(clean));
                        Engine.ui.closeModal();
                    } catch (e) {
                        alert("AI Error");
                    } finally {
                        btn.disabled = false;
                        btn.innerText = "GENERATE PROJECT";
                    }
                }
            },

            audio: {
                setVoice: (idx) => Engine.state.voice = Engine.tts.getVoices()[idx],
                setTrack: (url) => {
                    if (url === 'upload') document.getElementById('music-upload').click();
                    else Engine.audioEl.src = url;
                },
                handleUpload: (input) => {
                    if (input.files[0]) Engine.audioEl.src = URL.createObjectURL(input.files[0]);
                }
            },

            io: {
                apply: () => {
                    try {
                        Engine.load(JSON.parse(document.getElementById('json-editor').value));
                        Engine.ui.closeModal();
                    } catch (e) {
                        alert("Invalid JSON");
                    }
                }
            },

            ui: {
                toggleMenu: () => {
                    document.getElementById('system-menu').classList.toggle('open');
                    document.getElementById('menu-btn').classList.toggle('active');
                },
                openModal: (id) => {
                    document.getElementById('system-menu').classList.remove('open');
                    document.getElementById('modal-' + id).classList.add('open');
                    if (id === 'import') document.getElementById('json-editor').value = JSON.stringify(Engine.data, null, 2);
                },
                closeModal: () => document.querySelectorAll('.modal-overlay').forEach(e => e.classList.remove('open')),
                toggleRatio: () => document.getElementById('stage-content').classList.toggle('portrait'),
                toggleFullscreen: () => document.fullscreenElement ? document.exitFullscreen() : document.body.requestFullscreen(),
                update: () => {
                    document.getElementById('play-btn').innerHTML = Engine.state.paused ? '<i class="bi bi-play-fill"></i>' : '<i class="bi bi-pause-fill"></i>';
                }
            }
        };

        // --- OMNI-DEMO DATA (60 SCENES) ---
        const DEMO_DATA = {
            meta: {
                title: "Advanced Medical Microbiology: Unit-1 (B.Sc. Level)",
                audio: "https://res.cloudinary.com/dmttn34te/video/upload/v1763064765/study-music-181044_jbuwpq.mp3",
                lang: "bn-IN"
            },
            scenes: [
                // --- SCENE 1: OPENING TITLE ---
                {
                    html: `<div class="w-full h-full bg-[#000] flex flex-col items-center justify-center p-6 border-b-[8px] border-primary">
                <p class="text-blue-400 font-mono ts-sm tracking-[0.4em] mb-2">B.Sc. MICROBIOLOGY</p>
                <h1 id="t1" class="opacity-0 translate-y-4 ts-lg font-black text-white italic text-center transition-all duration-1000">MEDICAL MICROBIOLOGY<br>UNIT-1</h1>
                <div id="bar" class="w-0 h-1 bg-white my-4 transition-all duration-1000"></div>
                <h2 id="t2" class="opacity-0 translate-y-4 ts-sm font-light text-gray-400 uppercase transition-all duration-1000">Normal Microflora & Interaction</h2>
            </div>`,
                    steps: [{
                            narration: "সুপ্রভাত। আজ আমরা বিএসসি মেডিকেল মাইক্রোবায়োলজির প্রথম ইউনিট শুরু করছি। আমাদের আজকের আলোচনার বিষয় নরমাল মাইক্রোফ্লোরা এবং হোস্ট-প্যাথোজেন মিথস্ক্রিয়া।",
                            actions: [{
                                type: 'reveal',
                                target: '#t1'
                            }]
                        },
                        {
                            narration: "এই ইউনিটে আমরা অণুজীবের সুরক্ষা প্রদানকারী ভূমিকা এবং তাদের রোগ সৃষ্টি করার আণবিক প্রক্রিয়াগুলো বিশদভাবে জানব।",
                            actions: [{
                                type: 'reveal',
                                target: '#t2'
                            }, {
                                type: 'custom',
                                fn: () => document.getElementById('bar').style.width = '60%'
                            }]
                        }
                    ]
                },

                // --- SCENE 2: DEFINITION (ADVANCED) ---
                {
                    html: `<div class="w-full h-full bg-zinc-950 flex flex-col items-center justify-center p-8 text-center">
                <h3 class="text-primary ts-base font-bold mb-4 uppercase">Indigenous Microbiota</h3>
                <p id="p2" class="opacity-0 text-white ts-base leading-snug italic mb-6">"Microorganisms that establish a permanent residence without inducing pathology under homeostatic conditions."</p>
                <div class="w-full h-48 rounded-2xl overflow-hidden border border-white/10">
                    <img src="https://images.unsplash.com/photo-1583912267550-d44d7a125e6e?q=80&w=2000" class="w-full h-full object-cover grayscale opacity-60">
                </div>
            </div>`,
                    steps: [{
                        narration: "নরমাল মাইক্রোফ্লোরা বা ইন্ডিজেনাস মাইক্রোবায়োটা হলো সেই সব অণুজীব যারা সাধারণত আমাদের শরীরের সুস্থ অবস্থায় স্থায়ীভাবে বসবাস করে এবং কোনো রোগ সৃষ্টি করে না।",
                        actions: [{
                            type: 'reveal',
                            target: '#p2'
                        }]
                    }]
                },

                // --- SCENE 3: ESTABLISHMENT (P5.JS COLONIZATION) ---
                {
                    html: `<div id="p5-colony" class="w-full h-full bg-[#050505]"></div>
                   <div class="absolute top-10 left-10"><h4 class="text-blue-400 ts-sm font-black uppercase">Colonization Dynamics</h4></div>`,
                    script: `(ctx) => {
                new p5((p) => {
                    let bacteria = [];
                    p.setup = () => { p.createCanvas(ctx.root.offsetWidth, ctx.root.offsetHeight); };
                    p.draw = () => {
                        p.background(0, 30);
                        if(p.frameCount % 5 === 0) bacteria.push({x: p.random(p.width), y: p.random(p.height), r: 2, c: p.color(0, 150, 255)});
                        bacteria.forEach(b => {
                            p.fill(b.c); p.noStroke(); p.ellipse(b.x, b.y, b.r);
                            if(b.r < 15) b.r += 0.2;
                        });
                    };
                }, ctx.root.querySelector('#p5-colony'));
            }`,
                    steps: [{
                        narration: "জন্মের ঠিক পর থেকেই মানবদেহে এই অণুজীবদের কলোনাইজেশন বা বসতি স্থাপন শুরু হয়। ডায়েট, পরিবেশ এবং বয়স এই কলোনাইজেশন প্রক্রিয়াকে প্রভাবিত করে।",
                        actions: []
                    }]
                },

                // --- SCENE 4: PROTECTIVE FUNCTIONS (ICON GRID) ---
                {
                    html: `<div class="w-full h-full bg-black p-8 flex flex-col justify-center">
                <h2 class="text-white ts-base font-bold mb-8 border-l-4 border-primary pl-4">Protective Roles</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div id="f1" class="opacity-0 p-4 bg-zinc-900 rounded-xl border border-white/5"><b class="text-primary">Niche Exclusion:</b> Competing for attachment.</div>
                    <div id="f2" class="opacity-0 p-4 bg-zinc-900 rounded-xl border border-white/5"><b class="text-primary">Metabolic:</b> Vit K & B12 synthesis.</div>
                    <div id="f3" class="opacity-0 p-4 bg-zinc-900 rounded-xl border border-white/5"><b class="text-primary">Immune:</b> TLR priming.</div>
                    <div id="f4" class="opacity-0 p-4 bg-zinc-900 rounded-xl border border-white/5"><b class="text-primary">Antagonism:</b> Bacteriocins.</div>
                </div>
            </div>`,
                    steps: [{
                            narration: "এরা পুষ্টির জন্য প্যাথোজেনের সাথে প্রতিযোগিতা করে এবং ভিটামিন-কে ও বি-টুয়েলভ সংশ্লেষণে সাহায্য করে।",
                            actions: [{
                                type: 'reveal',
                                target: '#f1'
                            }, {
                                type: 'reveal',
                                target: '#f2'
                            }]
                        },
                        {
                            narration: "পাশাপাশি এরা ইমিউন সিস্টেমকে সক্রিয় রাখতে এবং ব্যাকটেরিওসিন নিঃসরণের মাধ্যমে শত্রু ব্যাকটেরিয়াকে ধ্বংস করতে সাহায্য করে।",
                            actions: [{
                                type: 'reveal',
                                target: '#f3'
                            }, {
                                type: 'reveal',
                                target: '#f4'
                            }]
                        }
                    ]
                },

                // --- SCENE 5: SKIN FLORA (STAPH EPIDERMIDIS) ---
                {
                    html: `<div class="w-full h-full relative">
                <img src="https://images.unsplash.com/photo-1516062423079-7ca13cdc7f5a?q=80&w=2000" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent flex flex-col justify-end p-8">
                    <h2 class="text-white ts-lg font-black italic">SKIN MICROFLORA</h2>
                    <p id="s5" class="opacity-0 text-blue-300 ts-base font-mono">Dominant: S. epidermidis</p>
                </div>
            </div>`,
                    steps: [{
                        narration: "ত্বকের প্রধান অণুজীব হলো স্ট্যাফাইলোকক্কাস এপিডারমিডিস। এরা ত্বকের ফ্যাটি অ্যাসিডকে ফ্যাটি অ্যাসিডে রূপান্তরিত করে ত্বকের পি-এইচ অম্লীয় রাখে, যা ক্ষতিকারক ব্যাকটেরিয়ার বৃদ্ধি রোধ করে।",
                        actions: [{
                            type: 'reveal',
                            target: '#s5'
                        }]
                    }]
                },

                // --- SCENE 6: BIOFILM KINETICS (P5.JS) ---
                {
                    html: `<div id="p5-bio" class="w-full h-full bg-[#0a0a0a]"></div>
                   <div class="absolute bottom-10 left-10"><h3 class="text-red-500 ts-base font-black uppercase">Biofilm Formation</h3></div>`,
                    script: `(ctx) => {
                new p5((p) => {
                    let matrix = [];
                    p.setup = () => { p.createCanvas(ctx.root.offsetWidth, ctx.root.offsetHeight); };
                    p.draw = () => {
                        p.background(10);
                        if(p.frameCount % 10 === 0) matrix.push({x: p.random(p.width), y: p.random(p.height), a: 0});
                        matrix.forEach(m => {
                            p.fill(239, 68, 68, m.a); p.noStroke();
                            p.rect(m.x, m.y, 40, 40, 10);
                            if(m.a < 150) m.a += 1;
                        });
                    };
                }, ctx.root.querySelector('#p5-bio'));
            }`,
                    steps: [{
                        narration: "ত্বক ক্ষতিগ্রস্ত হলে এই নরমাল ফ্লোরাগুলোই চিকিৎসায় ব্যবহৃত ক্যাথেটার বা ডিভাইসে 'বায়োফিল্ম' তৈরি করে সংক্রমণ ঘটাতে পারে। এটি বিএসসি স্তরের একটি গুরুত্বপূর্ণ ক্লিনিক্যাল কনসেপ্ট।",
                        actions: []
                    }]
                },

                // --- SCENE 7: ORAL MICROFLORA & DENTAL CARIES ---
                {
                    html: `<div class="w-full h-full bg-zinc-900 flex flex-col p-8">
                <h2 class="text-white ts-base font-bold mb-4 underline decoration-primary">Oral & Throat Microbiota</h2>
                <div class="flex-1 bg-black rounded-3xl p-6 flex flex-col justify-center gap-4">
                    <div id="o1" class="opacity-0 text-white ts-base border-l-4 border-green-500 pl-4">Streptococcus viridans (Commensal)</div>
                    <div id="o2" class="opacity-0 text-white ts-base border-l-4 border-red-500 pl-4">Streptococcus mutans (Cariogenic)</div>
                </div>
            </div>`,
                    steps: [{
                        narration: "মুখগহ্বরে স্ট্রেপ্টোকক্কাস ভিরিড্যান্স প্রধান ফ্লোরা হিসেবে থাকলেও, মিষ্টি জাতীয় খাদ্যের উপস্থিতিতে স্ট্রেপ্টোকক্কাস মিউট্যান্স দাঁতের এনামেল ক্ষয় করে ডেন্টাল ক্যারিস তৈরি করে।",
                        actions: [{
                            type: 'reveal',
                            target: '#o1'
                        }, {
                            type: 'reveal',
                            target: '#o2'
                        }]
                    }]
                },

                // --- SCENE 8: GUT DENSITY (CHART.JS LOG SCALE) ---
                {
                    html: `<div class="w-full h-full bg-black p-8 flex flex-col">
                <h2 class="text-white ts-base font-bold mb-4 text-center">GI Tract Microbial Density</h2>
                <div class="flex-1"><canvas id="ch-density"></canvas></div>
            </div>`,
                    script: `(ctx) => {
                ctx.chart('#ch-density', {
                    type: 'bar',
                    data: { labels: ['Stomach', 'Jejunum', 'Ileum', 'Colon'], datasets: [{ label: 'Log CFU/g', data: [3, 4, 8, 12], backgroundColor: '#6366f1' }] },
                    options: { scales: { y: { beginAtZero: true, grid: { color: '#222' }, ticks: { color: '#fff' } }, x: { ticks: { color: '#fff' } } } }
                });
            }`,
                    steps: [{
                        narration: "পরিপাকতন্ত্রে ব্যাকটেরিয়ার ঘনত্ব পাকস্থলী থেকে কোলনের দিকে ক্রমাগত বাড়তে থাকে। কোলনে এই ঘনত্ব প্রতি গ্রামে প্রায় ১০ টু দ্য পাওয়ার ১২ সি-এফ-ইউ পর্যন্ত পৌঁছায়।",
                        actions: []
                    }]
                },

                // --- SCENE 9: DYSBIOSIS (ADVANCED) ---
                {
                    html: `<div class="w-full h-full bg-red-950/20 flex flex-col items-center justify-center p-8 text-center">
                <h2 class="text-red-500 ts-lg font-black italic mb-4">DYSBIOSIS</h2>
                <p class="text-white ts-base leading-tight">Disruption of the microbial equilibrium leads to opportunistic domination.</p>
                <div id="dys" class="opacity-0 mt-8 p-4 bg-white/5 border border-red-500 rounded-xl text-red-500 font-mono ts-sm">Antibiotic Associated Diarrhea (C. difficile)</div>
            </div>`,
                    steps: [{
                        narration: "অ্যান্টিবায়োটিকের অপব্যবহারের ফলে নরমাল ফ্লোরার ভারসাম্য নষ্ট হয়ে 'ডিসবায়োসিস' ঘটে, যা ক্লস্ট্রিডিওডিস ডিফিকাল এর মতো প্যাথোজেনকে রোগ সৃষ্টির সুযোগ দেয়।",
                        actions: [{
                            type: 'reveal',
                            target: '#dys'
                        }]
                    }]
                },

                // --- SCENE 10: UROGENITAL LACTOBACILLUS ---
                {
                    html: `<div class="w-full h-full bg-[#0a1a0a] flex flex-col items-center justify-center p-10">
                <svg viewBox="0 0 100 100" class="w-1/2 mb-8">
                    <circle cx="50" cy="50" r="45" fill="none" stroke="#22c55e" stroke-width="2"/>
                    <text x="50" y="55" fill="#22c55e" text-anchor="middle" font-size="12" font-weight="bold">pH < 4.5</text>
                </svg>
                <h3 class="text-white ts-base font-bold">Vaginal Homeostasis</h3>
                <p class="text-gray-400 ts-sm mt-2">Lactobacillus species produce lactic acid & H2O2.</p>
            </div>`,
                    steps: [{
                        narration: "ইউরোজেনাইটাল ট্র্যাক্টে ল্যাকটোব্যাসিলাস প্রজাতি ল্যাকটিক অ্যাসিড তৈরি করে পি-এইচ ৪.৫ এর নিচে রাখে, যা ক্যান্ডিডার মতো প্যাথোজেনের বৃদ্ধি ঠেকিয়ে দেয়।",
                        actions: []
                    }]
                },

                // --- SCENE 11: HOST-PATHOGEN INTERACTION FLOW ---
                {
                    html: `<div class="w-full h-full bg-zinc-950 p-10 flex flex-col justify-center">
                <h2 class="text-primary ts-base font-black mb-10 text-center uppercase tracking-widest">Molecular Pathogenesis</h2>
                <div class="flex flex-col gap-4">
                    <div id="st1" class="opacity-0 p-4 bg-black border-l-4 border-blue-500 text-white">1. Adhesion (Pili/Adhesins)</div>
                    <div id="st2" class="opacity-0 p-4 bg-black border-l-4 border-green-500 text-white">2. Invasion (Hyaluronidase)</div>
                    <div id="st3" class="opacity-0 p-4 bg-black border-l-4 border-red-500 text-white">3. Evasion (Capsule/Antigenic Shift)</div>
                </div>
            </div>`,
                    steps: [{
                        narration: "প্যাথোজেনেসিস শুরু হয় হোস্ট সেলে অ্যাডহিশন বা আটকে থাকার মাধ্যমে। এরপর এনজাইমের সাহায্যে ইনভেসন এবং ইমিউন সিস্টেমকে ফাঁকি দেওয়ার মাধ্যমে সংক্রমণ পূর্ণতা পায়।",
                        actions: [{
                            type: 'reveal',
                            target: '#st1'
                        }, {
                            type: 'reveal',
                            target: '#st2'
                        }, {
                            type: 'reveal',
                            target: '#st3'
                        }]
                    }]
                },

                // --- SCENE 12: VIRULENCE TERMINOLOGY (LD50) ---
                {
                    html: `<div class="w-full h-full bg-black p-10 flex flex-col justify-center">
                <h2 class="text-white ts-base font-bold mb-8 italic border-b border-primary pb-2">Quantitative Pathogenicity</h2>
                <div class="grid grid-cols-1 gap-6">
                    <div id="v1" class="opacity-0"><b class="text-primary">LD50:</b> Lethal Dose required to kill 50% of test population.</div>
                    <div id="v2" class="opacity-0"><b class="text-primary">ID50:</b> Infectious Dose required to cause disease in 50% population.</div>
                </div>
            </div>`,
                    steps: [{
                        narration: "বিএসসি মাইক্রোবায়োলজিতে ভিরুলেন্স পরিমাপ করা হয় এল-ডি-ফিফটি এবং আই-ডি-ফিফটি এর মাধ্যমে। এটি সংক্রমণের তীব্রতার একটি গাণিতিক প্রকাশ।",
                        actions: [{
                            type: 'reveal',
                            target: '#v1'
                        }, {
                            type: 'reveal',
                            target: '#v2'
                        }]
                    }]
                },

                // --- SCENE 13: CARRIER STATE (CASE STUDY) ---
                {
                    html: `<div class="w-full h-full bg-[#111] flex flex-col items-center justify-center p-8 text-center border-x-4 border-white/5">
                <div class="w-24 h-24 bg-white/10 rounded-full flex items-center justify-center mb-6 border border-white/20">
                    <i class="bi bi-person-exclamation text-5xl text-blue-400"></i>
                </div>
                <h2 class="text-white ts-base font-bold">ASMPTOMATIC CARRIERS</h2>
                <p class="text-gray-500 ts-sm mt-4 italic">"Individuals who harbor the pathogen without overt clinical symptoms."</p>
                <p class="text-primary ts-sm font-mono mt-4">Example: Typhoid Mary (S. Typhi)</p>
            </div>`,
                    steps: [{
                        narration: "ক্যারিয়ার বা বাহকরা হলো সেই সব ব্যক্তি যারা প্যাথোজেন বহন করে কিন্তু নিজেরা অসুস্থ হয় না। টাইফয়েড মেরি এর একটি ধ্রুপদী উদাহরণ।",
                        actions: []
                    }]
                },

                // --- SCENE 14: OPPORTUNISTIC PATHOGENS ---
                {
                    html: `<div class="w-full h-full relative">
                <img src="https://images.unsplash.com/photo-1579152276502-54243b85360f?q=80&w=2000" class="w-full h-full object-cover opacity-30 grayscale">
                <div class="absolute inset-0 flex flex-col items-center justify-center p-12 text-center bg-blue-900/10">
                    <h2 class="text-white ts-xl font-black italic tracking-tighter">OPPORTUNISTIC</h2>
                    <p id="o14" class="opacity-0 text-blue-400 ts-base font-bold mt-4">Compromised Host Defense = Pathological Transition</p>
                </div>
            </div>`,
                    steps: [{
                        narration: "ইমিউন সিস্টেম দুর্বল হয়ে পড়লে আমাদের শরীরের বন্ধু মাইক্রোফ্লোরাই 'অপর্চুনিস্টিক প্যাথোজেন' হিসেবে আত্মপ্রকাশ করে রোগ সৃষ্টি করতে পারে।",
                        actions: [{
                            type: 'reveal',
                            target: '#o14'
                        }]
                    }]
                },

                // --- SCENE 15: NOSOCOMIAL (HOSPITAL ACQUIRED) ---
                {
                    html: `<div class="w-full h-full bg-zinc-950 p-8 flex flex-col">
                <h2 class="text-red-500 ts-base font-black mb-6 uppercase">Nosocomial Infections (HAI)</h2>
                <div class="flex-1 bg-black/50 border border-white/5 rounded-3xl p-8 flex flex-col justify-center">
                    <ul class="text-white ts-base space-y-4 font-light">
                        <li>• Acquired > 48hrs after admission.</li>
                        <li>• Major source: Medical Devices.</li>
                        <li>• High antibiotic resistance (ESKAPE Pathogens).</li>
                    </ul>
                </div>
            </div>`,
                    backup_svg: `<svg viewBox="0 0 100 100" class="bg-red-900"><rect x="40" y="20" width="20" height="60" fill="white"/><rect x="20" y="40" width="60" height="20" fill="white"/></svg>`,
                    steps: [{
                        narration: "নসোকোমিয়াল ইনফেকশন হলো সেই সব সংক্রমণ যা হাসপাতালে ভর্তির ৪৮ ঘণ্টা পর শুরু হয়। এগুলো সাধারণত মাল্টি-ড্রাগ রেজিস্ট্যান্ট হয়ে থাকে।",
                        actions: []
                    }]
                },

                // --- SCENE 16: MODES OF TRANSMISSION (GRID) ---
                {
                    html: `<div class="w-full h-full bg-black p-8">
                <h2 class="text-white ts-base font-bold mb-8">Advanced Transmission Modes</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div id="tr1" class="opacity-0 p-4 bg-zinc-900 rounded-xl">Fomites (Inanimate)</div>
                    <div id="tr2" class="opacity-0 p-4 bg-zinc-900 rounded-xl">Droplet Nuclei (< 5μm)</div>
                    <div id="tr3" class="opacity-0 p-4 bg-zinc-900 rounded-xl">Zoonotic (Animal)</div>
                    <div id="tr4" class="opacity-0 p-4 bg-zinc-900 rounded-xl">Iatrogenic (Clinical)</div>
                </div>
            </div>`,
                    steps: [{
                        narration: "সংক্রমণ বিভিন্ন উপায়ে ছড়ায়; যেমন ফোমাইট বা নির্জীব বস্তুর মাধ্যমে, ড্রপলেট নিউক্লিয়াসের মাধ্যমে অথবা সরাসরি ল্যাবরেটরি দুর্ঘটনার মাধ্যমে।",
                        actions: [{
                            type: 'reveal',
                            target: '#tr1'
                        }, {
                            type: 'reveal',
                            target: '#tr2'
                        }, {
                            type: 'reveal',
                            target: '#tr3'
                        }, {
                            type: 'reveal',
                            target: '#tr4'
                        }]
                    }]
                },

                // --- SCENE 17: LPS STRUCTURE (ADVANCED SVG) ---
                {
                    html: `<div class="w-full h-full bg-[#0a0a0a] flex flex-col items-center justify-center p-10">
                <h2 class="text-red-500 ts-base font-black italic mb-10">LPS (Endotoxin) Architecture</h2>
                <svg viewBox="0 0 300 150" class="w-full max-w-lg">
                    <rect id="lipid" x="20" y="60" width="60" height="40" fill="#ef4444" rx="5"/>
                    <text x="50" y="85" fill="white" text-anchor="middle" font-size="8">Lipid A</text>
                    <rect x="80" y="70" width="80" height="20" fill="#f97316"/>
                    <text x="120" y="85" fill="white" text-anchor="middle" font-size="8">Core</text>
                    <path d="M160,80 L280,80" stroke="#eab308" stroke-width="12" stroke-dasharray="10"/>
                    <text x="220" y="65" fill="#eab308" text-anchor="middle" font-size="8">O-Antigen</text>
                </svg>
            </div>`,
                    steps: [{
                        narration: "এন্ডোটক্সিন বা এল-পি-এস এর আণবিক গঠনে লিপিড-এ হলো বিষাক্ত অংশ। এটি গ্রাম-নেগেটিভ ব্যাকটেরিয়ার মৃত্যুর পর নির্গত হয় এবং হোস্টের ইমিউন সিস্টেমকে আক্রমণ করে।",
                        actions: []
                    }]
                },

                // --- SCENE 18: LPS TLR4 SIGNALING (SVG ANIMATION) ---
                {
                    html: `<div class="w-full h-full bg-black flex flex-col items-center justify-center p-8">
                <svg viewBox="0 0 200 150" class="w-3/4">
                    <line x1="20" y1="100" x2="180" y2="100" stroke="#333" stroke-width="5"/> <!-- Membrane -->
                    <path id="receptor" d="M100,100 L100,60" stroke="#6366f1" stroke-width="4"/>
                    <circle id="lps-dot" cx="100" cy="20" r="6" fill="#ef4444" class="opacity-0"/>
                </svg>
                <div id="storm" class="opacity-0 mt-8 p-4 bg-red-600/30 border border-red-600 rounded text-red-500 font-black ts-base">CYTOKINE STORM</div>
            </div>`,
                    steps: [{
                            narration: "লিপিড-এ হোস্ট সেলের TLR4 রিসেপ্টরের সাথে যুক্ত হয়ে প্রো-ইনফ্ল্যামেটরি সাইটোকাইন নিঃসরণ শুরু করে।",
                            actions: [{
                                type: 'custom',
                                fn: () => {
                                    document.getElementById('lps-dot').classList.remove('opacity-0');
                                    document.getElementById('lps-dot').setAttribute('cy', '50');
                                }
                            }]
                        },
                        {
                            narration: "এর ফলে সাইটোকাইন স্টর্ম তৈরি হয়, যা টিস্যু ড্যামেজ এবং সেপ্টিক শকের মূল কারণ। এটি একটি জটিল প্যাথোফিজিওলজিক্যাল প্রক্রিয়া।",
                            actions: [{
                                type: 'reveal',
                                target: '#storm'
                            }]
                        }
                    ]
                },

                // --- SCENE 19: CLINICAL SPECIMEN PRINCIPLES ---
                {
                    html: `<div class="w-full h-full bg-[#0d1117] p-8 flex flex-col justify-center">
                <h2 class="text-green-400 ts-base font-mono mb-4 border-b border-white/10">> Clinical_Asepsis_Protocol</h2>
                <pre class="w-full bg-black/50 p-6 rounded-2xl border border-white/5"><code class="language-javascript text-blue-300 ts-sm" id="code-proc">
// B.Sc. Standard Sampling
1. Avoid Commensal Contamination
2. Representative Sample Site
3. Optimal Volume (Blood: 10-20ml)
4. Cold Chain Maintenance (2-8°C)
                </code></pre>
            </div>`,
                    script: `(ctx) => Prism.highlightElement(ctx.root.querySelector('#code-proc'))`,
                    steps: [{
                        narration: "ক্লিনিক্যাল নমুনা সংগ্রহের সময় নরমাল ফ্লোরা দ্বারা দূষণ রোধ করতে হবে। মনে রাখবেন, রিপোর্টের নির্ভুলতা নির্ভর করে নমুনার গুণমানের ওপর।",
                        actions: []
                    }]
                },

                // --- SCENE 20: SUMMARY & CLOSING ---
                {
                    html: `<div class="w-full h-full bg-black flex flex-col items-center justify-center p-10 border-[10px] border-zinc-900 text-center">
                <h1 id="end-t" class="opacity-0 ts-lg font-black text-white italic transition-all duration-1000">LECTURE END</h1>
                <div class="w-24 h-1 bg-primary my-4"></div>
                <p class="text-gray-500 font-mono ts-sm uppercase tracking-widest">Medical Microbiology Series</p>
                <p class="text-primary ts-sm mt-4">Next Unit: Advanced Immunology</p>
            </div>`,
                    steps: [{
                        narration: "আজকের আলোচনা এখানেই শেষ। নরমাল ফ্লোরার ভারসাম্য এবং প্যাথোজেনেসিসের আণবিক প্রক্রিয়াগুলো পরীক্ষার জন্য অত্যন্ত গুরুত্বপূর্ণ। পরবর্তী ক্লাসে আমরা ইমিউনোলজি নিয়ে আলোচনা করব। ধন্যবাদ।",
                        actions: [{
                            type: 'reveal',
                            target: '#end-t'
                        }]
                    }]
                }
            ]
        };
        window.onload = Engine.init;
    </script>
</body>

</html>
